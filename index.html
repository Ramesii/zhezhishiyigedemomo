<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>é˜¿é‡Œäº‘ RTS åŒè§†é¢‘æ’­æ”¾ + GELLO é¥æ“ä½œ</title>
  <!-- å¼•å…¥é˜¿é‡Œäº‘æ’­æ”¾å™¨ CSS -->
  <link rel="stylesheet" href="https://g.alicdn.com/de/prismplayer/2.9.9/skins/default/aliplayer-min.css" />
  <style>
    :root {
      --primary-color: #007AFF;
      --primary-dark: #0056CC;
      --secondary-color: #6C47FF;
      --accent-color: #00C4CC;
      --accent-purple: #9D4EDD;
      --accent-pink: #FF2E93;
      --dark-bg: #0A0E17;
      --dark-card: #151A28;
      --dark-border: #2A3445;
      --text-primary: #F0F4F8;
      --text-secondary: #B0B8C5;
      --text-muted: #6B7280;
      --success-color: #10B981;
      --warning-color: #F59E0B;
      --danger-color: #EF4444;
      --glow-primary: 0 0 15px rgba(0, 122, 255, 0.5);
      --glow-secondary: 0 0 15px rgba(108, 71, 255, 0.5);
      --glow-accent: 0 0 15px rgba(0, 196, 204, 0.5);
    }
    
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    body {
      font-family: 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: 
        radial-gradient(circle at 10% 20%, rgba(108, 71, 255, 0.15) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(0, 196, 204, 0.15) 0%, transparent 20%),
        radial-gradient(circle at 50% 50%, rgba(157, 78, 221, 0.1) 0%, transparent 30%),
        linear-gradient(135deg, var(--dark-bg) 0%, #0F1525 100%);
      color: var(--text-primary);
      margin: 0;
      padding: 0;
      line-height: 1.6;
      min-height: 100vh;
      overflow-x: hidden;
    }
    
    .container {
      max-width: 1600px;
      width: 100%;
      margin: 0 auto;
      padding: 20px;
      position: relative;
      z-index: 1;
    }
    
    /* ç§‘æŠ€æ„ŸèƒŒæ™¯å…ƒç´  */
    .tech-bg-element {
      position: fixed;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      z-index: 0;
      pointer-events: none;
    }
    
    .tech-grid {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        linear-gradient(rgba(15, 23, 42, 0.2) 1px, transparent 1px),
        linear-gradient(90deg, rgba(15, 23, 42, 0.2) 1px, transparent 1px);
      background-size: 50px 50px;
      opacity: 0.3;
    }
    
    .floating-element {
      position: absolute;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--accent-color), var(--accent-purple));
      filter: blur(40px);
      opacity: 0.1;
      animation: float 20s infinite linear;
    }
    
    .floating-element:nth-child(1) {
      width: 300px;
      height: 300px;
      top: 10%;
      left: 5%;
      animation-delay: 0s;
    }
    
    .floating-element:nth-child(2) {
      width: 200px;
      height: 200px;
      top: 60%;
      left: 80%;
      animation-delay: -5s;
      background: linear-gradient(135deg, var(--secondary-color), var(--accent-pink));
    }
    
    .floating-element:nth-child(3) {
      width: 150px;
      height: 150px;
      top: 80%;
      left: 20%;
      animation-delay: -10s;
      background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
    }
    
    @keyframes float {
      0% {
        transform: translate(0, 0) rotate(0deg);
      }
      33% {
        transform: translate(30px, -50px) rotate(120deg);
      }
      66% {
        transform: translate(-20px, 20px) rotate(240deg);
      }
      100% {
        transform: translate(0, 0) rotate(360deg);
      }
    }
    
    /* å¤´éƒ¨åŒºåŸŸ */
    .header {
      text-align: center;
      padding: 30px 0;
      margin-bottom: 20px;
      position: relative;
    }
    
    .header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 150px;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color), var(--accent-color));
      border-radius: 3px;
    }
    
    h1 {
      font-size: 36px;
      font-weight: 800;
      margin-bottom: 15px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color), var(--accent-color));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: 0 0 20px rgba(108, 71, 255, 0.3);
      letter-spacing: -0.5px;
    }
    
    .subtitle {
      font-size: 16px;
      color: var(--text-secondary);
      max-width: 700px;
      margin: 0 auto;
      line-height: 1.5;
    }
    
    /* æ’­æ”¾å™¨åŒºåŸŸ - æ”¾å¤§ç‰ˆ */
    .players-container {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
      margin-bottom: 30px;
    }
    
    .player-wrapper {
      flex: 1;
      min-width: 500px; /* å¢åŠ æœ€å°å®½åº¦ */
      position: relative;
      background: linear-gradient(145deg, var(--dark-card), #101725);
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border: 1px solid var(--dark-border);
    }
    
    .player-wrapper::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
      z-index: 2;
    }
    
    .player-wrapper:hover {
      transform: translateY(-8px);
      box-shadow: 
        0 15px 35px rgba(0, 0, 0, 0.5),
        var(--glow-primary);
    }
    
    .player-title {
      text-align: center;
      padding: 18px;
      font-size: 20px; /* å¢å¤§å­—ä½“ */
      font-weight: 600;
      background: rgba(15, 23, 42, 0.6);
      border-bottom: 1px solid var(--dark-border);
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }
    
    .player-title::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.5s;
    }
    
    .player-wrapper:hover .player-title::before {
      left: 100%;
    }
    
    .player-title::after {
      content: 'â—';
      color: var(--accent-color);
      margin-right: 10px;
      font-size: 14px;
      text-shadow: 0 0 8px var(--accent-color);
    }
    
    #J_prismPlayer1, #J_prismPlayer2 {
      width: 100%;
      height: 0;
      padding-bottom: 65%; /* å¢åŠ é«˜åº¦æ¯”ä¾‹ */
      position: relative;
      background: #000;
    }
    
    #J_prismPlayer1 .prism-player, #J_prismPlayer2 .prism-player {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    
    /* å»¶è¿Ÿæ˜¾ç¤º */
    .latency-display {
      text-align: center;
      margin: 30px 0;
      padding: 25px;
      background: linear-gradient(145deg, var(--dark-card), #101725);
      border-radius: 16px;
      box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      border: 1px solid var(--dark-border);
      position: relative;
      overflow: hidden;
    }
    
    .latency-display::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
    }
    
    .latency-value {
      font-size: 48px;
      font-weight: 800;
      margin: 15px 0;
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: 0 0 20px rgba(0, 122, 255, 0.3);
    }
    
    .latency-label {
      font-size: 16px;
      color: var(--text-secondary);
      letter-spacing: 1px;
    }
    
    /* æ§åˆ¶æŒ‰é’® */
    .controls {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 12px;
      margin: 30px 0;
    }
    
    button {
      background: linear-gradient(145deg, var(--dark-card), #101725);
      color: var(--text-primary);
      border: 1px solid var(--dark-border);
      padding: 12px 20px;
      cursor: pointer;
      font-size: 14px;
      min-width: 140px;
      border-radius: 12px;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      font-weight: 500;
      position: relative;
      overflow: hidden;
      box-shadow: 
        0 5px 15px rgba(0, 0, 0, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
    }
    
    button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      transition: left 0.5s;
    }
    
    button:hover::before {
      left: 100%;
    }
    
    button:hover {
      transform: translateY(-3px);
      box-shadow: 
        0 8px 20px rgba(0, 0, 0, 0.3),
        var(--glow-primary);
      border-color: var(--primary-color);
    }
    
    button:active {
      transform: translateY(1px);
    }
    
    button.active {
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      color: white;
      border-color: var(--primary-color);
      box-shadow: 
        0 5px 15px rgba(0, 122, 255, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }
    
    button:disabled {
      background: #1A2235;
      color: var(--text-muted);
      cursor: not-allowed;
      border-color: var(--dark-border);
      transform: none;
      box-shadow: none;
    }
    
    button:disabled::before {
      display: none;
    }
    
    /* åŒºåŸŸå¡ç‰‡ */
    .section {
      background: linear-gradient(145deg, var(--dark-card), #101725);
      border-radius: 16px;
      padding: 25px;
      margin: 25px 0;
      box-shadow: 
        0 10px 30px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      border: 1px solid var(--dark-border);
      position: relative;
      overflow: hidden;
    }
    
    .section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
    }
    
    .section h3 {
      margin-top: 0;
      font-size: 20px;
      font-weight: 700;
      margin-bottom: 20px;
      color: var(--text-primary);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .section h3::before {
      content: '';
      display: block;
      width: 4px;
      height: 20px;
      background: linear-gradient(to bottom, var(--primary-color), var(--accent-color));
      border-radius: 2px;
    }
    
    .section p {
      margin: 12px 0;
      font-size: 14px;
      color: var(--text-secondary);
      line-height: 1.6;
    }
    
    /* çŠ¶æ€æŒ‡ç¤ºå™¨ */
    .status-indicator {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 14px;
      font-weight: 500;
      background: rgba(15, 23, 42, 0.5);
      border: 1px solid var(--dark-border);
    }
    
    .status-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      display: inline-block;
    }
    
    .status-ready {
      background-color: var(--success-color);
      box-shadow: 0 0 8px var(--success-color);
    }
    
    .status-warning {
      background-color: var(--warning-color);
      box-shadow: 0 0 8px var(--warning-color);
    }
    
    .status-error {
      background-color: var(--danger-color);
      box-shadow: 0 0 8px var(--danger-color);
    }
    
    .status-loading {
      background-color: var(--accent-color);
      box-shadow: 0 0 8px var(--accent-color);
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0% { 
        opacity: 1; 
        box-shadow: 0 0 8px var(--accent-color);
      }
      50% { 
        opacity: 0.5; 
        box-shadow: 0 0 12px var(--accent-color);
      }
      100% { 
        opacity: 1; 
        box-shadow: 0 0 8px var(--accent-color);
      }
    }
    
    /* é”™è¯¯æ¶ˆæ¯ */
    .error-message {
      color: var(--danger-color);
      background-color: rgba(239, 68, 68, 0.1);
      padding: 12px 15px;
      margin-top: 15px;
      border-radius: 12px;
      border-left: 4px solid var(--danger-color);
      display: none;
      font-size: 14px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
    
    /* åè®®ä¿¡æ¯ */
    .protocol-info {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }
    
    .protocol-item {
      flex: 1;
      min-width: 250px;
      background: linear-gradient(145deg, rgba(15, 23, 42, 0.6), rgba(10, 14, 23, 0.8));
      border-radius: 12px;
      padding: 20px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      border: 1px solid var(--dark-border);
      position: relative;
      overflow: hidden;
    }
    
    .protocol-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2px;
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
    }
    
    .protocol-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
    }
    
    .protocol-item h4 {
      margin: 0 0 15px 0;
      font-weight: 700;
      font-size: 18px;
      color: var(--text-primary);
    }
    
    .protocol-item ul {
      list-style: none;
      padding: 0;
    }
    
    .protocol-item li {
      margin-bottom: 10px;
      color: var(--text-secondary);
      display: flex;
      align-items: flex-start;
      line-height: 1.5;
    }
    
    .protocol-item li::before {
      content: 'âœ“';
      color: var(--accent-color);
      margin-right: 8px;
      font-weight: bold;
      flex-shrink: 0;
    }
    
    /* ä¿¡æ¯ç½‘æ ¼ */
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }
    
    .info-item {
      display: flex;
      flex-direction: column;
      padding: 15px;
      background: linear-gradient(145deg, rgba(15, 23, 42, 0.5), rgba(10, 14, 23, 0.7));
      border-radius: 12px;
      border: 1px solid var(--dark-border);
      transition: transform 0.3s ease;
    }
    
    .info-item:hover {
      transform: translateY(-3px);
    }
    
    .info-label {
      font-size: 12px;
      color: var(--text-muted);
      margin-bottom: 5px;
      letter-spacing: 0.5px;
    }
    
    .info-value {
      font-size: 14px;
      color: var(--text-primary);
      font-weight: 500;
    }
    
    /* é¡µè„š */
    .footer {
      text-align: center;
      padding: 30px 0;
      margin-top: 40px;
      border-top: 1px solid var(--dark-border);
      color: var(--text-muted);
      font-size: 14px;
      position: relative;
    }
    
    .footer::before {
      content: '';
      position: absolute;
      top: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 2px;
      background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
    }
    
    .footer-logo {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-bottom: 15px;
    }
    
    .logo-icon {
      width: 24px;
      height: 24px;
      background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
      border-radius: 6px;
      position: relative;
      overflow: hidden;
    }
    
    .logo-icon::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    }
    
    /* å“åº”å¼è°ƒæ•´ */
    @media (max-width: 1200px) {
      .player-wrapper {
        min-width: 450px;
      }
    }
    
    @media (max-width: 1024px) {
      .player-wrapper {
        min-width: 400px;
      }
    }
    
    @media (max-width: 900px) {
      .players-container {
        flex-direction: column;
      }
      
      .player-wrapper {
        min-width: 100%;
      }
      
      .protocol-info {
        flex-direction: column;
      }
      
      .controls {
        flex-direction: column;
        align-items: center;
      }
      
      button {
        width: 100%;
        max-width: 300px;
      }
    }
    
    @media (max-width: 768px) {
      h1 {
        font-size: 28px;
      }
      
      .subtitle {
        font-size: 14px;
      }
      
      .player-title {
        font-size: 18px;
      }
      
      #J_prismPlayer1, #J_prismPlayer2 {
        padding-bottom: 56.25%; /* åœ¨å°å±å¹•ä¸Šæ¢å¤16:9æ¯”ä¾‹ */
      }
    }
  </style>
</head>
<body>
  <!-- ç§‘æŠ€æ„ŸèƒŒæ™¯å…ƒç´  -->
  <div class="tech-bg-element">
    <div class="tech-grid"></div>
    <div class="floating-element"></div>
    <div class="floating-element"></div>
    <div class="floating-element"></div>
  </div>
  
  <div class="container">
    <div class="header">
      <h1>é˜¿é‡Œäº‘ RTS åŒè§†é¢‘æ’­æ”¾ + GELLO é¥æ“ä½œ</h1>
      <p class="subtitle">ä¸“ä¸šçº§è¶…ä½å»¶è¿Ÿç›´æ’­è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒ 200ms-400ms å®æ—¶è§†é¢‘ä¼ è¾“ä¸æœºæ¢°è‡‚æ§åˆ¶</p>
    </div>
    
    <div class="players-container">
      <div class="player-wrapper">
        <div class="player-title">ä¸»è§†é¢‘æµ</div>
        <div id="J_prismPlayer1"></div>
      </div>
      <div class="player-wrapper">
        <div class="player-title">è¾…åŠ©è§†é¢‘æµ</div>
        <div id="J_prismPlayer2"></div>
      </div>
    </div>
    
    <div class="latency-display">
      <div class="latency-label">å½“å‰å»¶è¿Ÿ</div>
      <div class="latency-value" id="latency-value">--</div>
      <div class="latency-label">æ¯«ç§’</div>
    </div>
    
    <div class="controls">
      <button id="play-btn" onclick="playBothVideos()">
        <span>â–¶</span> æ’­æ”¾å…¨éƒ¨
      </button>
      <button id="pause-btn" onclick="pauseBothVideos()">
        <span>â¸</span> æš‚åœå…¨éƒ¨
      </button>
      <button onclick="toggleMuteBoth()">
        <span>ğŸ”‡</span> é™éŸ³/å–æ¶ˆé™éŸ³
      </button>
      <button onclick="switchToLowLatency()" id="low-latency-btn">
        <span>âš¡</span> è¶…ä½å»¶è¿Ÿæ¨¡å¼
      </button>
      <button onclick="switchToStandard()" id="standard-btn">
        <span>ğŸ”„</span> æ ‡å‡†å…¼å®¹æ¨¡å¼
      </button>
    </div>

    <div class="section">
      <h3>æœºæ¢°è‡‚é¥æ“ä½œæ§åˆ¶</h3>
      <button onclick="startGelloTeleop()" id="gello-btn">
        <span>ğŸ¤–</span> å¯åŠ¨ GELLO é¥æ“ä½œ
      </button>
      <p style="font-size:14px; color:var(--text-muted); margin-top:15px;">
        ç‚¹å‡»åå°†è‡ªåŠ¨æ‰“å¼€ä¸¤ä¸ªç»ˆç«¯ï¼Œåˆ†åˆ«è¿è¡Œæœºå™¨äººèŠ‚ç‚¹ä¸æ§åˆ¶ç¯å¢ƒï¼Œå®ç°è¿œç¨‹æœºæ¢°è‡‚ç²¾ç¡®æ§åˆ¶
      </p>
    </div>
    
    <div class="section">
      <h3>æ’­æ”¾ä¸ç³»ç»Ÿä¿¡æ¯</h3>
      <div class="info-grid">
        <div class="info-item">
          <div class="info-label">æ’­æ”¾çŠ¶æ€</div>
          <div class="info-value">
            <span class="status-indicator">
              <span class="status-dot status-ready"></span>
              <span id="status">å‡†å¤‡å°±ç»ª</span>
            </span>
          </div>
        </div>
        <div class="info-item">
          <div class="info-label">å½“å‰åè®®</div>
          <div class="info-value" id="current-protocol">ARTC (è¶…ä½å»¶è¿Ÿ)</div>
        </div>
        <div class="info-item">
          <div class="info-label">ä¸»æ’­æ”¾åœ°å€</div>
          <div class="info-value" id="url-display1"></div>
        </div>
        <div class="info-item">
          <div class="info-label">ç¬¬äºŒæ’­æ”¾åœ°å€</div>
          <div class="info-value" id="url-display2"></div>
        </div>
        <div class="info-item">
          <div class="info-label">æµè§ˆå™¨</div>
          <div class="info-value" id="browser-info"></div>
        </div>
        <div class="info-item">
          <div class="info-label">GELLO åç«¯çŠ¶æ€</div>
          <div class="info-value">
            <span class="status-indicator">
              <span class="status-dot status-warning"></span>
              <span id="gello-backend-status">æœªæ£€æµ‹</span>
            </span>
          </div>
        </div>
      </div>
      <div id="error-message" class="error-message"></div>
    </div>
    
    <div class="section">
      <h3>å»¶è¿Ÿè¯´æ˜</h3>
      <p>â€¢ <strong style="color:var(--accent-color);">ARTCåè®®</strong>: 200ms-400ms è¶…ä½å»¶è¿Ÿï¼ˆæ¨èç”¨äºå®æ—¶äº¤äº’åœºæ™¯ï¼‰</p>
      <p>â€¢ <strong style="color:var(--text-secondary);">FLV/HLSåè®®</strong>: 3-30ç§’ å¸¸è§„å»¶è¿Ÿï¼ˆæä¾›æ›´å¥½çš„æµè§ˆå™¨å…¼å®¹æ€§ï¼‰</p>
    </div>
    
    <div class="protocol-info">
      <div class="protocol-item">
        <h4>è¶…ä½å»¶è¿Ÿæ¨¡å¼</h4>
        <ul>
          <li>ä½¿ç”¨ ARTC åè®® (åŸºäº WebRTC)</li>
          <li>å»¶è¿Ÿ: 200ms-400ms</li>
          <li>ä¼˜åŠ¿: å®æ—¶äº’åŠ¨ä½“éªŒï¼Œé€‚ç”¨äºè¿œç¨‹æ§åˆ¶</li>
          <li>æŠ€æœ¯: WebRTC åº•å±‚ä¼˜åŒ–</li>
        </ul>
      </div>
      <div class="protocol-item">
        <h4>æ ‡å‡†å…¼å®¹æ¨¡å¼</h4>
        <ul>
          <li>ä½¿ç”¨ FLV/HLS åè®®</li>
          <li>å»¶è¿Ÿ: 3-30ç§’</li>
          <li>ä¼˜åŠ¿: æ›´å¥½çš„æµè§ˆå™¨å…¼å®¹æ€§</li>
          <li>æŠ€æœ¯: æ ‡å‡†æµåª’ä½“ä¼ è¾“</li>
        </ul>
      </div>
    </div>
    
    <div class="footer">
      <div class="footer-logo">
        <div class="logo-icon"></div>
        <span>é˜¿é‡Œäº‘ RTS è¶…ä½å»¶è¿Ÿç›´æ’­è§£å†³æ–¹æ¡ˆ</span>
      </div>
      <p>ä¸“ä¸šçº§è¿œç¨‹æ§åˆ¶ä¸è§†é¢‘ä¼ è¾“å¹³å°</p>
    </div>
  </div>

  <!-- å¼•å…¥é˜¿é‡Œäº‘æ’­æ”¾å™¨ JS -->
  <script src="https://g.alicdn.com/de/prismplayer/2.9.9/aliplayer-min.js"></script>

  <script>
    // RTSæ’­æ”¾åœ°å€ï¼ˆartc://åè®®ï¼‰
    const RTS_PLAY_URL1 = "artc://a.zhezhishiyigedemo.me/live/live";
    const RTS_PLAY_URL2 = "artc://c.zhezhishiyigedemo.me/live/live";
    
    // è½¬æ¨åŸŸååœ°å€ï¼ˆç”¨äºæ ‡å‡†åè®®å…¼å®¹ï¼‰
    const STANDARD_FLV_URL1 = "http://c.zhezhishiyigedemo.me/live/live.flv";
    const STANDARD_FLV_URL2 = "http://c.zhezhishiyigedemo.me/live/live2.flv";
    const STANDARD_HLS_URL1 = "http://c.zhezhishiyigedemo.me/live/live.m3u8";
    const STANDARD_HLS_URL2 = "http://c.zhezhishiyigedemo.me/live/live2.m3u8";
    
    let player1, player2;
    let currentMode = 'low-latency';
    let latencyTimer;

    // åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
      document.getElementById('url-display1').textContent = RTS_PLAY_URL1;
      document.getElementById('url-display2').textContent = RTS_PLAY_URL2;
      
      const userAgent = navigator.userAgent;
      let browserInfo = 'å…¶ä»–æµè§ˆå™¨';
      if (userAgent.includes('Edg')) {
        browserInfo = 'Microsoft Edge';
      } else if (userAgent.includes('Chrome')) {
        browserInfo = 'Google Chrome';
      } else if (userAgent.includes('Firefox')) {
        browserInfo = 'Mozilla Firefox';
      }
      document.getElementById('browser-info').textContent = browserInfo;
      
      createPlayers();
      startLatencySimulation();
      checkGelloBackend(); // æ£€æµ‹åç«¯æ˜¯å¦è¿è¡Œ
      updateModeButtons();
    });

    // æ£€æµ‹ GELLO åç«¯æ˜¯å¦å¯ç”¨
    async function checkGelloBackend() {
      try {
        const res = await fetch('http://127.0.0.1:5001/health');
        if (res.ok) {
          document.getElementById('gello-backend-status').textContent = 'å·²å°±ç»ª';
          const statusDot = document.querySelector('#gello-backend-status').previousElementSibling;
          statusDot.className = 'status-dot status-ready';
        } else {
          throw new Error('Health check failed');
        }
      } catch (e) {
        document.getElementById('gello-backend-status').textContent = 'æœªè¿è¡Œï¼ˆè¯·å…ˆå¯åŠ¨ gello_control.pyï¼‰';
        const statusDot = document.querySelector('#gello-backend-status').previousElementSibling;
        statusDot.className = 'status-dot status-warning';
      }
    }

    // å¯åŠ¨ GELLO é¥æ“ä½œ
    async function startGelloTeleop() {
      const btn = document.getElementById('gello-btn');
      btn.disabled = true;
      btn.innerHTML = '<span class="status-dot status-loading"></span> å¯åŠ¨ä¸­...';

      try {
        const response = await fetch('http://127.0.0.1:5001/start_gello', {
          method: 'POST'
        });
        const data = await response.json();
        
        if (response.ok) {
          document.getElementById('status').textContent = 'GELLO é¥æ“ä½œå·²å¯åŠ¨ï¼';
          const statusDot = document.querySelector('#status').previousElementSibling;
          statusDot.className = 'status-dot status-ready';
          alert('GELLO é¥æ“ä½œå·²å¯åŠ¨ï¼\nè¯·æŸ¥çœ‹æ–°æ‰“å¼€çš„ä¸¤ä¸ªç»ˆç«¯çª—å£ã€‚');
        } else {
          throw new Error(data.message || 'æœªçŸ¥é”™è¯¯');
        }
      } catch (error) {
        console.error('å¯åŠ¨é¥æ“ä½œå¤±è´¥:', error);
        showError('æ— æ³•å¯åŠ¨é¥æ“ä½œï¼š' + error.message + 'ï¼ˆè¯·ç¡®è®¤ gello_control.py æ­£åœ¨è¿è¡Œï¼‰');
        document.getElementById('status').textContent = 'å¯åŠ¨é¥æ“ä½œå¤±è´¥';
        const statusDot = document.querySelector('#status').previousElementSibling;
        statusDot.className = 'status-dot status-error';
      } finally {
        btn.disabled = false;
        btn.innerHTML = '<span>ğŸ¤–</span> å¯åŠ¨ GELLO é¥æ“ä½œ';
      }
    }
    
    // åˆ›å»ºæ’­æ”¾å™¨
    function createPlayers() {
      const config1 = {
        id: "J_prismPlayer1",
        isLive: true,
        autoplay: true,
        useH5Prism: true,
        width: '100%',
        height: '100%'
      };
      
      const config2 = {
        id: "J_prismPlayer2",
        isLive: true,
        autoplay: true,
        useH5Prism: true,
        width: '100%',
        height: '100%'
      };
      
      if (currentMode === 'low-latency') {
        config1.source = RTS_PLAY_URL1;
        config1.rtsFallback = true;
        config1.rtsFallbackType = 'FLV';
        config1.fallbackUrl = STANDARD_FLV_URL1;
        
        config2.source = RTS_PLAY_URL2;
        config2.rtsFallback = true;
        config2.rtsFallbackType = 'FLV';
        config2.fallbackUrl = STANDARD_FLV_URL2;
        
        document.getElementById('current-protocol').textContent = 'ARTC (è¶…ä½å»¶è¿Ÿ)';
      } else {
        config1.source = STANDARD_FLV_URL1;
        config2.source = STANDARD_FLV_URL2;
        document.getElementById('current-protocol').textContent = 'FLV (æ ‡å‡†å…¼å®¹)';
      }
      
      if (player1) player1.dispose();
      if (player2) player2.dispose();
      
      player1 = new Aliplayer(config1, function(player) {
        console.log("æ’­æ”¾å™¨1åˆ›å»ºæˆåŠŸ");
        document.getElementById('status').textContent = 'æ’­æ”¾å™¨1å·²å°±ç»ª';
        updateButtonStates();
      });
      
      player2 = new Aliplayer(config2, function(player) {
        console.log("æ’­æ”¾å™¨2åˆ›å»ºæˆåŠŸ");
        document.getElementById('status').textContent = 'æ’­æ”¾å™¨2å·²å°±ç»ª';
        updateButtonStates();
      });
      
      bindPlayerEvents();
    }
    
    function bindPlayerEvents() {
      // Player 1
      player1.on("rtsTraceId", () => {
        document.getElementById('status').textContent = 'æ’­æ”¾å™¨1æ­£åœ¨æ’­æ”¾ (è¶…ä½å»¶è¿Ÿ)';
        const statusDot = document.querySelector('#status').previousElementSibling;
        statusDot.className = 'status-dot status-ready';
      });
      
      player1.on("rtsFallback", (e) => {
        document.getElementById('status').textContent = 'æ’­æ”¾å™¨1å·²é™çº§: ' + e.paramData.reason;
        const statusDot = document.querySelector('#status').previousElementSibling;
        statusDot.className = 'status-dot status-warning';
      });
      
      player1.on("error", (e) => {
        document.getElementById('status').textContent = 'æ’­æ”¾å™¨1æ’­æ”¾å‡ºé”™';
        const statusDot = document.querySelector('#status').previousElementSibling;
        statusDot.className = 'status-dot status-error';
        showError("æ’­æ”¾å™¨1é”™è¯¯: " + (e.message || JSON.stringify(e)));
      });
      
      player1.on("play", () => { 
        document.getElementById('status').textContent = 'æ’­æ”¾å™¨1æ­£åœ¨æ’­æ”¾'; 
        const statusDot = document.querySelector('#status').previousElementSibling;
        statusDot.className = 'status-dot status-ready';
        updateButtonStates(); 
      });
      
      player1.on("pause", () => { 
        document.getElementById('status').textContent = 'æ’­æ”¾å™¨1å·²æš‚åœ'; 
        const statusDot = document.querySelector('#status').previousElementSibling;
        statusDot.className = 'status-dot status-warning';
        updateButtonStates(); 
      });
      
      // Player 2
      player2.on("rtsTraceId", () => {
        document.getElementById('status').textContent = 'æ’­æ”¾å™¨2æ­£åœ¨æ’­æ”¾ (è¶…ä½å»¶è¿Ÿ)';
        const statusDot = document.querySelector('#status').previousElementSibling;
        statusDot.className = 'status-dot status-ready';
      });
      
      player2.on("rtsFallback", (e) => {
        document.getElementById('status').textContent = 'æ’­æ”¾å™¨2å·²é™çº§: ' + e.paramData.reason;
        const statusDot = document.querySelector('#status').previousElementSibling;
        statusDot.className = 'status-dot status-warning';
      });
      
      player2.on("error", (e) => {
        document.getElementById('status').textContent = 'æ’­æ”¾å™¨2æ’­æ”¾å‡ºé”™';
        const statusDot = document.querySelector('#status').previousElementSibling;
        statusDot.className = 'status-dot status-error';
        showError("æ’­æ”¾å™¨2é”™è¯¯: " + (e.message || JSON.stringify(e)));
      });
      
      player2.on("play", () => { 
        document.getElementById('status').textContent = 'æ’­æ”¾å™¨2æ­£åœ¨æ’­æ”¾'; 
        const statusDot = document.querySelector('#status').previousElementSibling;
        statusDot.className = 'status-dot status-ready';
        updateButtonStates(); 
      });
      
      player2.on("pause", () => { 
        document.getElementById('status').textContent = 'æ’­æ”¾å™¨2å·²æš‚åœ'; 
        const statusDot = document.querySelector('#status').previousElementSibling;
        statusDot.className = 'status-dot status-warning';
        updateButtonStates(); 
      });
    }
    
    function playBothVideos() { 
      player1.play(); 
      player2.play(); 
    }
    
    function pauseBothVideos() { 
      player1.pause(); 
      player2.pause(); 
    }
    
    function toggleMuteBoth() {
      const newMute = !(player1.getMuted() || player2.getMuted());
      player1.setMuted(newMute);
      player2.setMuted(newMute);
    }
    
    function switchToLowLatency() {
      if (currentMode !== 'low-latency') {
        currentMode = 'low-latency';
        createPlayers();
        document.getElementById('status').textContent = 'åˆ‡æ¢åˆ°è¶…ä½å»¶è¿Ÿæ¨¡å¼';
        const statusDot = document.querySelector('#status').previousElementSibling;
        statusDot.className = 'status-dot status-ready';
        updateModeButtons();
      }
    }
    
    function switchToStandard() {
      if (currentMode !== 'standard') {
        currentMode = 'standard';
        createPlayers();
        document.getElementById('status').textContent = 'åˆ‡æ¢åˆ°æ ‡å‡†å…¼å®¹æ¨¡å¼';
        const statusDot = document.querySelector('#status').previousElementSibling;
        statusDot.className = 'status-dot status-warning';
        updateModeButtons();
      }
    }
    
    function updateButtonStates() {
      const playBtn = document.getElementById('play-btn');
      const pauseBtn = document.getElementById('pause-btn');
      const isPlaying = (player1 && player1.isPlaying()) || (player2 && player2.isPlaying());
      playBtn.disabled = isPlaying;
      pauseBtn.disabled = !isPlaying;
    }
    
    function updateModeButtons() {
      const lowLatencyBtn = document.getElementById('low-latency-btn');
      const standardBtn = document.getElementById('standard-btn');
      
      if (currentMode === 'low-latency') {
        lowLatencyBtn.classList.add('active');
        standardBtn.classList.remove('active');
      } else {
        standardBtn.classList.add('active');
        lowLatencyBtn.classList.remove('active');
      }
    }
    
    function showError(message) {
      const el = document.getElementById('error-message');
      el.textContent = message;
      el.style.display = 'block';
    }
    
    function hideError() {
      document.getElementById('error-message').style.display = 'none';
    }
    
    function startLatencySimulation() {
      clearInterval(latencyTimer);
      latencyTimer = setInterval(() => {
        const el = document.getElementById('latency-value');
        if (currentMode === 'low-latency') {
          el.textContent = Math.floor(Math.random() * 200) + 200;
        } else {
          el.textContent = Math.floor(Math.random() * 7000) + 3000;
        }
      }, 1000);
    }
    
    window.addEventListener('beforeunload', function() {
      clearInterval(latencyTimer);
      if (player1) player1.dispose();
      if (player2) player2.dispose();
    });
  </script>
</body>
</html>
